<!DOCTYPE html>
<html>

<head>

    <link href="https://fonts.googleapis.com/css?family=Baloo+Bhai&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Kanit&display=swap" rel="stylesheet">

    <style type="text/css">
        #mina {
            display: none;
            overflow: hidden;
        }
		
		#textCircle {
			margin-right: 0px;
		}
    </style>

</head>

<body style="font-family: 'Kanit', sans-serif;">


    <div id="mina" class="row" style="margin-top: 650px;">
        <center>
            <div class="first circle col-lg-4">
                <div id="textCircle" style="font-size: 14px; color: white;">animation <br/> progress</div>
            </div>
        </center>
    </div>

    <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="circle-progress.js"></script>
    <script>
        $(function() {
            window.onload = (e) => {
                window.addEventListener('message', (event) => {
                    var item = event.data;
                    if (item !== undefined && item.type === "ui") {
                        if (item.display === true) {
                            $("#mina").show();
                            console.log("starting this shit!");
                            var start = new Date();
                            var maxTime = item.time;
                            var text = item.text;
                            var timeoutVal = Math.floor(maxTime / 100);
                            animateUpdate();

                            $('#textCircle').text(text);



                            /*
                            $('#pbar_innertext').text(text);

                            function updateProgress(percentage) {
                                $('#pbar_innerdiv').css("width", percentage + "%");
                            }
							*/


                            function animateUpdate() {
                                var now = new Date();
                                var timeDiff = now.getTime() - start.getTime();
                                var perc = Math.round((timeDiff / maxTime) * 100);
                                var perc2 = perc / 100;
                                console.log(perc);
                                if (perc <= 100) {
                                    $('.first.circle').circleProgress({
                                        value: perc2,
                                        animation: false,
                                        fill: {
                                            gradient: ['#FF6800', '#FF9C57']
                                        }
                                    });
                                    $('#percent').html("<strong style='color:#fff'>" + perc + '<i>%</i></strong>');


                                    setTimeout(animateUpdate, timeoutVal);
                                } else {
                                    $("#mina").hide();
                                }
                            }




                        } else {
                            $("#mina").hide();
                        }
                    }
                });
            };
        });
    </script>

</body>

</html>